function initDirectionsHover(){$("div#routeDirections").on("mouseenter","tr",function(){$targetRow=$(this),$targetRow.addClass("highlight"),$("div.nearby",$targetRow).show(),$("td",$targetRow).addClass("highlight");var rowHeight=$targetRow.height(),currentDiv=$("div.nearby",$targetRow),padding=10;currentDiv.css("top",rowHeight-padding);var loc=$targetRow.data("loc");if(null!=loc&&""!=loc){var arrLatLng=$targetRow.data("loc").split(",");aaRP.addRouteStepMarker(arrLatLng[0],arrLatLng[1])}}),$("div#routeDirections").on("mouseleave","tr",function(){$targetRow=$(this),$targetRow.removeClass("highlight"),$("div.nearby",$targetRow).hide(),$("td",$targetRow).removeClass("highlight"),aaRP.hideRouteStepMarker()}),$("div#routeDirections").on("click",function(event){var $target=$(event.target),$targetRow=$target.closest("tr"),loc=$targetRow.data("loc");if(null!=loc&&""!=loc){var arrLatLng=loc.split(",");showAAMapLocation($target,$targetRow,arrLatLng[0],arrLatLng[1])}})}function callAutoComplete(inputID){0!=aaRP.acCallTimer&&clearTimeout(aaRP.acCallTimer),aaRP.acCallTimer=setTimeout(function(){getAutoCompleteList(inputID)},300)}function initPageInteraction(){$("#map-tabs-nav li.map-tabs-selected a").click(function(){return resetInputFields(),!1}),$("#toggleRouteOptions").click(function(){return $("#summaryChecks").slideToggle("fast"),forceRepaint(),!1}),$("#closeChecks img").click(function(){return $("#summaryChecks").slideToggle("fast"),forceRepaint(),!1}),$("#inputFields").bind("change keyup",function(event){var $tgt=$(event.target);if($tgt.is("input")&&($tgt.hasClass("routeText")||$tgt.hasClass("routeTextVia"))){var keycode=event.which;if(setWhiteBG($tgt[0]),"change"==event.type){switch($tgt.attr("id")){case"routeFrom":isNewFromValue=!0,$("#confirmFrom").val("");break;case"routeTo":isNewToValue=!0,$("#confirmTo").val("");break;case"via0":isNewVia0Value=!0,$("#viaChoice0").val("");break;case"via1":isNewVia1Value=!0,$("#viaChoice1").val("");break;case"via2":isNewVia2Value=!0,$("#viaChoice2").val("");break;case"via3":isNewVia3Value=!0,$("#viaChoice3").val("");break;case"via4":isNewVia4Value=!0,$("#viaChoice4").val("")}return}if(void 0!=keycode&&0!=keycode&&13!=keycode&&9!=keycode&&16!=keycode&&17!=keycode&&18!=keycode&&40!=keycode&&38!=keycode)switch($tgt.attr("id")){case"routeFrom":isNewFromValue=!0,$("#confirmFrom").val(""),aaRP.autoComplete.inpID="routeFrom",aaRP.autoComplete.confirmID="confirmFrom",callAutoComplete("routeFrom"),""==$("#routeFrom").val()?(aaRP.storage.displayHistoryLink(),event.stopPropagation()):$("#lnkRecentLocations").hide();break;case"routeTo":isNewToValue=!0,$("#confirmTo").val(""),aaRP.autoComplete.inpID="routeTo",aaRP.autoComplete.confirmID="confirmTo",callAutoComplete("routeTo");break;case"via0":isNewVia0Value=!0,$("#viaChoice0").val(""),aaRP.autoComplete.inpID="via0",aaRP.autoComplete.confirmID="viaChoice0",callAutoComplete("via0");break;case"via1":isNewVia1Value=!0,$("#viaChoice1").val(""),aaRP.autoComplete.inpID="via1",aaRP.autoComplete.confirmID="viaChoice1",callAutoComplete("via1");break;case"via2":isNewVia2Value=!0,$("#viaChoice2").val(""),aaRP.autoComplete.inpID="via2",aaRP.autoComplete.confirmID="viaChoice2",callAutoComplete("via2");break;case"via3":isNewVia3Value=!0,$("#viaChoice3").val(""),aaRP.autoComplete.inpID="via3",aaRP.autoComplete.confirmID="viaChoice3",callAutoComplete("via3");break;case"via4":isNewVia4Value=!0,$("#viaChoice4").val(""),aaRP.autoComplete.inpID="via4",aaRP.autoComplete.confirmID="viaChoice4",callAutoComplete("via4")}else 9==keycode&&hideAllMatchLists()}}),$("#route").bind("click",function(e){var $etarget=$(e.target);eid=$etarget.attr("id"),$etarget.hasClass("routeTextVia")||(void 0==eid||void 0!=eid&&-1==eid.indexOf("linkToggle"))&&("lnkRecentLocations"==eid?("visible"==aaRP.storage.matchListState?hideAllMatchLists():hideAllMatchLists(!0),e.preventDefault(),$("#routeFrom").focus()):hideAllMatchLists())}),$("#inputFields").bind("focusin",function(e){aaDebug("Focus event on inputfields fired");var eTgt=$(e.target);eTgt.hasClass("autocompleteitem")||eTgt.hasClass("matchWrapper")||eTgt.hasClass("storageHistoryItem")?e.stopPropagation():$(e.target).is("a")?e.stopPropagation():"routeFrom"==eTgt.attr("id")?""==$("#routeFrom").val()?aaRP.storage.displayHistoryLink():$("#lnkRecentLocations").hide():"visible"==aaRP.storage.matchListState?hideAllMatchLists(!0):hideAllMatchLists()}),$("#inputFields").bind("keydown",function(e){if(aaDebug("keydown on inputfields fired"),40==e.which){if($ac=$("#"+aaRP.autoComplete.confirmID+"-list,#confirmFrom-list.storageHistory"),0!=$ac.length&&$ac.children().length>0){var $hlElem=$(".acHighlight",$ac);0==$hlElem.length||$hlElem.is(":last-child")?($(".matchplace",$ac).removeClass("acHighlight"),$selectedACElem=$(".matchplace",$ac).first(),$selectedACElem.addClass("acHighlight"),$selectedACElem.hasClass("storageHistoryItem")&&aaRP.storage.selectHistoryItem($selectedACElem.attr("data-gaz"),"routeFrom","confirmFrom",!1)):$hlElem.is(":last-child")||($(".matchplace",$ac).removeClass("acHighlight"),$hlElemNext=$hlElem.next(),$hlElemNext.addClass("acHighlight"),$selectedACElem.hasClass("storageHistoryItem")&&aaRP.storage.selectHistoryItem($hlElemNext.attr("data-gaz"),"routeFrom","confirmFrom",!1))}}else if(38==e.which){if($ac=$("#"+aaRP.autoComplete.confirmID+"-list"),0!=$ac.length&&$ac.children().length>0){var $hlElem=$(".acHighlight",$ac);$hlElem.is(":first-child")?($(".matchplace",$ac).removeClass("acHighlight"),hideAllMatchLists()):($(".matchplace",$ac).removeClass("acHighlight"),$hlElemPrev=$hlElem.prev(),$hlElemPrev.addClass("acHighlight"),$selectedACElem.hasClass("storageHistoryItem")&&aaRP.storage.selectHistoryItem($hlElemPrev.attr("data-gaz"),"routeFrom","confirmFrom",!1))}}else 9==e.which&&(0!=aaRP.acCallTimer&&clearTimeout(aaRP.acCallTimer),hideAllMatchLists())}),$("#inputFields").click(function(event){aaDebug("click event on inputfields fired");var $target=$(event.target);1==$target.length&&$target.is("div")&&$target.hasClass("autocompleteitem")?selectACNodeMatch($(event.target).attr("data-placeId"),$(event.target).attr("data-desc"),aaRP.autoComplete.confirmID,aaRP.autoComplete.inpID):1==$target.length&&$target.is("div")&&$target.hasClass("storageHistoryItem")?aaRP.storage.selectHistoryItem($(event.target).attr("data-gaz"),"routeFrom","confirmFrom",!0):1==$target.length&&"lnkRecentLocations"==$target.attr("id")&&aaRP.storage.showHistory("#routeFrom")}),$("#addViaLink a").click(function(event){createVia(),event.preventDefault()}),$("#linkSettings").click(function(event){event.preventDefault?event.preventDefault():event.returnValue=!1,aaRP.displayPanel("routeSettings")}),$(document).on("click","#linkSettingsReturnRoutePlanner",function(event){event.preventDefault?event.preventDefault():event.returnValue=!1,aaRP.displayPanel("route")}),aaRP.storage.displayHistoryLink(),$(document).on("click","#routeSummary",function(event){var $altTgt=$(event.target);if($altTgt.hasClass("altDistTime")||$altTgt.hasClass("altSummary")||$altTgt.hasClass("altRouteRow")){showLoading(),aaRP.fn.hideAltRoute(),$("#routeSummary .altRouteRow").off();var $routeSummaryElement=$("#routeSummary");$routeSummaryElement.html("");var routeDirectionsElement=document.getElementById("routeDirections");routeDirectionsElement.innerHTML="&nbsp;",clearAllPOIMarkers(),null!=routeOverlay&&routeOverlay.setMap(null),aaInfoWindow.close();var clickedAltRoute=$(event.target).closest(".altRouteRow").data("altroute");if(null!=clickedAltRoute&&void 0!=clickedAltRoute){window.console&&console.log("clickedAltRouteID:"+clickedAltRoute),aaRP.selectedAltRoute=clickedAltRoute;var tmpResult={};$.extend(tmpResult,aaRP.gDirResult),tmpResult.routes=new Array(aaRP.gDirResult.routes[aaRP.selectedAltRoute]);var googleRoute=reformatGoogleRouteResponse(tmpResult);googleRoute.routeGenerationTime=0;var selectedChannel="route-planner-v3g";$("#avoidTraffic").prop("checked")&&(selectedChannel="route-planner-v3gt");var reqParamsWithDirs={gr:googleRoute,processSignposting:!0,removeOriginalSignposting:!1,processPOIs:!0,showPOIsInRouteText:!0,processTollZones:!0,channel:selectedChannel};retrieveAADirections(reqParamsWithDirs),fetchDestinationSensitiveAds(!1)}}}),$(document).on("click","#lnkClearRecentLocations",function(e){aaRP.storage.clearHistory(),e.preventDefault()})}function checkHashValues(){try{if(-1!=hashvalue.indexOf("|")&&-1!=hashvalue.indexOf("toNode")&&-1!=hashvalue.indexOf("fromNode")&&hashvalue.indexOf("toNode")>hashvalue.indexOf("fromNode")){var hashfromNode=stripNode(hashvalue.substring(hashvalue.indexOf("fromNode")+9,hashvalue.indexOf("|toNode"))),gazRegex=/toNode=\d*(%7C|\|)[^&?]*/,tmpValue=gazRegex.exec(hashvalue);if(null==tmpValue)return!1;var hashtoNode=stripNode(tmpValue[0].substring(7,tmpValue[0].length));if(!aaRP.fn.isValidGazNode(hashfromNode)||!aaRP.fn.isValidGazNode(hashtoNode))return!1;var hashfromPlace=getGazPlaceFromString(hashfromNode),hashtoPlace=getGazPlaceFromString(hashtoNode);return $("#confirmFrom").val(formatGazStringAsLatLngString(hashfromNode)),$("#confirmTo").val(formatGazStringAsLatLngString(hashtoNode)),$("#routeTo").val(hashtoPlace),$("#routeFrom").val(hashfromPlace),isNewFromValue=!1,isNewToValue=!1,getRouteAndDestinationHotelsAndAds(),!0}}catch(e){return!1}return!1}function onGetRouteClicked(isPageInputParameter){$("#routeMessage").html("").hide(),$("#routeTargetedAd").hide(),draggedRoute=!1;var routeFrom=document.getElementById("routeFrom"),routeTo=document.getElementById("routeTo"),confirmFrom=document.getElementById("confirmFrom"),confirmTo=document.getElementById("confirmTo"),confirmTo=document.getElementById("confirmTo");aaRP.hasPlaceErrors=!1,showLoading(),setTimeout(function(){populateFields(routeFrom,routeTo,confirmFrom,confirmTo)},100)}function getRouteAndDestinationHotelsAndAds(setDatabaseFlag){null==setDatabaseFlag&&(setDatabaseFlag=!0),$("#routeTargetedAd").hide(),$("#classiclink").hide(),onGetNewRoute(!0,"",setDatabaseFlag),toggleStreetView(aaPanorama,"hide"),""!=document.getElementById("confirmTo").value&&(populateHotelsBarGaz(),setTimeout(function(){fetchDestinationSensitiveAds(!1)},3e3))}function updateDestinationsForAdAgencies(){_switchVars={};var fromElementValue=document.getElementById("confirmFrom").value;""!=fromElementValue&&(_switchVars.from=getGazPlaceFromString(fromElementValue));var toElementValue=document.getElementById("confirmTo").value;""!=toElementValue&&(_switchVars.to=getGazPlaceFromString(toElementValue))}function extractTownOrPostCode(confirmedLocationString){var location=confirmedLocationString,routePartsTo=confirmedLocationString.split(",");if(routePartsTo.length>1){location=routePartsTo[0];var indexOfPipe=location.lastIndexOf("|");location=location.substring(indexOfPipe+1)}return location}function stripNode(str){var strOut=str.replace(/([^a-z0-9 ,'.|-])|(script)/gi,"");return strOut}function toggleStreetView(panorama,state){"hide"==state?panorama.setVisible(!1):"show"==state&&panorama.setVisible(!0)}function populateFields(from,to,confFrom,confTo){aaRP.gazRequestCount=0,setWhiteBG(from),setWhiteBG(to),aaRP.fn.checkAndSetNewGazValues()?(aaRP.fn.doGazSearch("routeFrom"),aaRP.fn.doGazSearch("routeTo"),aaRP.fn.doGazSearchVias()):0==aaRP.gazRequestCount&&(showLoading(),getRouteAndDestinationHotelsAndAds())}function populateGeoCodeField(results,$confirmPlace,$searchPlace){var strMatchSummary="",strSelectHTML="",strPlace="",$tmpMatchElem=$("#"+$confirmPlace.attr("id")+"Matches");$tmpMatchElem.html("").hide();var strGeoGaz="",gbireBiasLocPos=0,arrFormattedAddr=[];for(cnt=0;cnt<results.length;cnt++){if(0==gbireBiasLocPos){var addr=results[cnt].formatted_address;(-1!=addr.indexOf(", UK")||-1!=addr.indexOf(", United Kingdom")||-1!=addr.indexOf(", Ireland")||-1!=addr.indexOf(", Isle of Man")||-1!=addr.indexOf(", Jersey")||-1!=addr.indexOf(", Guernsey"))&&(gbireBiasLocPos=cnt)}strPlace=new String(results[cnt].formatted_address),strPlace.length>34&&(strPlace=strPlace.slice(0,31)+"..."),strGeoGaz="0|"+results[cnt].formatted_address.replace(/'/g,"&#8217;")+"||"+results[cnt].geometry.location.lng().toFixed(6)+"|"+results[cnt].geometry.location.lat().toFixed(6),strSelectHTML+="\n<div class='matchplace' node='"+strGeoGaz+"'><a href='#' onclick=\"selectNodeMatch('"+strGeoGaz+"','"+$confirmPlace.attr("id")+"','"+$searchPlace.attr("id")+"');return false;\">"+strPlace+"</a></div>"}var strOutputVal="";-1==results[gbireBiasLocPos].formatted_address.indexOf(",")&&(strOutputVal=results[gbireBiasLocPos].formatted_address);try{arrFormattedAddr=results[gbireBiasLocPos].formatted_address.split(","),trim(arrFormattedAddr[0].toLowerCase())==trim(arrFormattedAddr[1].toLowerCase())&&arrFormattedAddr.shift(),trim(arrFormattedAddr[0].toLowerCase())==trim(arrFormattedAddr[1].toLowerCase())&&arrFormattedAddr.shift(),arrFormattedAddr[0]=trim(arrFormattedAddr[0]),strOutputVal=arrFormattedAddr.join(",")}catch(e){}$searchPlace.val(strOutputVal),$confirmPlace.val("0|"+strOutputVal+"||"+results[gbireBiasLocPos].geometry.location.lng().toFixed(6)+"|"+results[gbireBiasLocPos].geometry.location.lat().toFixed(6)),cnt>1&&(strMatchSummary=cnt+" matches",strMatchSummary+=" found -  <a href='#' id='linkToggle"+$confirmPlace.attr("id")+"' onclick=\"toggleMatchList(this,'"+$confirmPlace.attr("id")+"-list');return false;\">select from list</a>",strSelectHTML="<div id='"+$confirmPlace.attr("id")+"-list' class='matchWrapper'>"+strSelectHTML+"</div>",$tmpMatchElem.html(strMatchSummary+strSelectHTML).show()),resetInputNewValue($searchPlace.attr("id"),!1),0!=aaRP.gazRequestCount||aaRP.hasPlaceErrors?0==aaRP.gazRequestCount&&hideLoading():(showLoading(),getRouteAndDestinationHotelsAndAds())}function resetInputNewValue(inputID,blnValue){switch(inputID){case"routeTo":isNewToValue=blnValue;break;case"routeFrom":isNewFromValue=blnValue;break;case"via0":isNewVia0Value=blnValue;break;case"via1":isNewVia1Value=blnValue;break;case"via2":isNewVia2Value=blnValue;break;case"via3":isNewVia3Value=blnValue;break;case"via4":isNewVia4Value=blnValue;break;case"via5":isNewVia5Value=blnValue}}function createVia(){if(viaCount>viaLimit)return $("#routeMessage").html("Sorry, only "+(viaLimit+1)+" via locations allowed.").show(),forceRepaint(),!1;var message="Please enter a location";if(0!=viaCount){var prev=document.getElementById("via"+(viaCount-1).toString());if(0==prev.value.length||prev.value==message)return prev.value=message,setErrorBG(prev),!1;setWhiteBG(prev)}var viaId="via"+viaCount.toString(),label=$("<label>Via: </label>");label.attr("for",viaId);var $inputRowWrapper=$('<div class="inputViaRowWrapper"><a href="#" onclick="removeVia('+viaCount+');return false;" class="removeVia"><img width="10" height="10" alt="Remove via" src="/images/routes/btn-10-close.gif"/></a></div>'),input=$('<input type="text" class="routeTextVia" />');input.attr("id",viaId),input.attr("name",viaId),input.keypress(searchFieldKeypress);var inputSpanWrapper=$('<span class="inputViaWrapper"></span>');inputSpanWrapper.append(input),$inputRowWrapper.append(inputSpanWrapper);var c=$("#avoidTrafficContainer"),newdiv=$('<div class="twocolinp"></div>'),inpHidden=$('<input type="hidden" id="viaChoice'+viaCount+'">');newdiv.attr("id","routeVia"+viaCount),"Microsoft Internet Explorer"!=navigator.appName&&newdiv.css("display","none"),newdiv.append(label),newdiv.append($inputRowWrapper),newdiv.append(inpHidden);var viaMatchesElem=$('<div id="viaChoice'+viaCount+'Matches" class="locSearchMatches"></div>');return newdiv.insertBefore(c),viaMatchesElem.insertBefore(c),"Microsoft Internet Explorer"!=navigator.appName&&newdiv.slideDown("fast"),forceRepaint(),resetInputNewValue(viaId,!0),viaCount++,viaCount>=viaLimit&&$("div > .via").text(""),!1}function createViaDropDown(){var dropDownId="viaChoice"+viaCountDropDown.toString();return viaCountDropDown++,dropDownId}function clearViaMatches(){for(var inc=0;viaCount>=inc;inc++)$("#viaChoice"+inc.toString()).html(""),$("#viaChoice"+inc.toString()+"Matches").html("")}function clearViaInputs(){for(var inc=0;viaCount>=inc;inc++){var c=$("#routeVia"+inc.toString());c.remove();var cm=$("#viaChoice"+inc.toString()+"Matches");cm.remove()}viaCount=0}function removeVia(viaNo){if($("#routeMessage").text("").hide(),viaNo!=viaCount-1)return void $("#routeMessage").text("Please remove the last 'via' first!").show();var $elem=$("#routeVia"+viaNo);$elem.remove();var $elemMatches=$("#viaChoice"+viaNo+"Matches");$elemMatches.remove(),gMarkers.length==viaCount+2&&(gMarkers[viaNo+1].setMap(null),gMarkers.splice(viaNo+1,1),resetRouteMarkerIcons(),null!=routeOverlay&&routeOverlay.setMap(null)),forceRepaint(),viaCount--}function resetRouteMarkerIcons(){for(selectedMarker=0;selectedMarker<gMarkers.length;selectedMarker++){var IconOrigin=26*selectedMarker,IconHeight=135;(null==IconOrigin||0>IconOrigin)&&(IconOrigin=0),Icon={url:"/resources/images/maps/map-sprite-005.png",size:new google.maps.Size(26,34),origin:new google.maps.Point(IconOrigin,IconHeight),anchor:new google.maps.Point(13,34)},gMarkers[selectedMarker].setIcon(Icon),gMarkers[selectedMarker].routePosition=selectedMarker}}function reverseRoute(){var tmpFromPlace=$("#routeFrom").val(),tmpToPlace=$("#routeTo").val(),tmpFromSelect=$("#confirmFrom").val(),tmpToSelect=$("#confirmTo").val();if(""==tmpFromSelect||""==tmpToSelect)return void $("#routeMessage").text("Please request a route before reversing.").show();for(var arrViaText=new Array,arrViaOptions=new Array,i=0;viaCount>i;i++)arrViaText.push($("#via"+i).val()),arrViaOptions.push($("#viaChoice"+i).val());$("#routeFrom").val(tmpToPlace),$("#routeTo").val(tmpFromPlace),$("#confirmFrom").val(tmpToSelect),$("#confirmTo").val(tmpFromSelect),arrViaText.reverse(),arrViaOptions.reverse();for(var i=0;viaCount>i;i++)$("#via"+i).val(arrViaText[i]),$("#viaChoice"+i).val(arrViaOptions[i]);tmpFromPlace="",tmpToPlace="",tmpFromSelect="",tmpToSelect="",arrViaText="",arrViaOptions="",resetNewValues(!1),getRouteAndDestinationHotelsAndAds()}function searchFieldKeypress(e){if(13==e.which){if($ac=$("#"+aaRP.autoComplete.confirmID+"-list, #confirmFrom-list.storageHistory"),"block"==$ac.css("display")&&0!=$(".acHighlight",$ac).length){var $selectedACElem=$(".acHighlight",$ac);if(0!=$selectedACElem.length)return $(".matchplace",$ac).removeClass("acHighlight"),selectACNodeMatch($selectedACElem.attr("data-placeId"),$selectedACElem.attr("data-desc"),aaRP.autoComplete.confirmID,aaRP.autoComplete.inpID),hideAllMatchLists(),$(".matchWrapper").html("").hide().css("position","static"),void aaRP.storage.hideHistoryLink()}showLoading(),draggedRoute=!1,$("#classiclink").hide(),$(".locSearchMatches").html("").hide();var routeFrom=document.getElementById("routeFrom"),routeTo=document.getElementById("routeTo"),confirmFrom=document.getElementById("confirmFrom"),confirmTo=document.getElementById("confirmTo");aaRP.hasPlaceErrors=!1,setTimeout(function(){populateFields(routeFrom,routeTo,confirmFrom,confirmTo)},100)}}function reset(){return clearViaDropDowns(),!0}function resetInputFields(){var fromText=document.getElementById("routeFrom"),toText=document.getElementById("routeTo");setWhiteBG(fromText),fromText.value="",setWhiteBG(toText),toText.value="",clearViaInputs(),resetNewValues(!0)}function resetNewValues(blnNewValue){$(".locSearchMatches").html("").hide(),(void 0==blnNewValue||1!=blnNewValue&&0!=blnNewValue)&&(blnNewValue=!0),isNewFromValue=blnNewValue,isNewToValue=blnNewValue,isNewVia0Value=blnNewValue,isNewVia1Value=blnNewValue,isNewVia2Value=blnNewValue,isNewVia3Value=blnNewValue,isNewVia4Value=blnNewValue}function setErrorBG(widget){$(widget).addClass("alertError"),$(widget).removeClass("inputSpinner")}function setWhiteBG(widget){$(widget).removeAttr("style").removeClass("alertError").removeClass("inputSpinner")}function toggleMatchList(obj,id){var $elem=$("#"+id),tmpDisplayValue=$elem.css("display");if($(".matchWrapper").hide().css("position","static"),"none"==tmpDisplayValue){$elem.show();var pos=$elem.position();$elem.css({position:"absolute",marginLeft:0,marginTop:0,top:pos.top+2,left:pos.left}),obj.innerHTML="hide list"}else obj.innerHTML="select from list";return!1}function hideAllMatchLists(bolShowRecentHistoryLink){aaDebug("hideallmatchlists fired, bolShowRecentHistoryLink="+bolShowRecentHistoryLink),$(".matchWrapper").hide().css("position","static"),$(".locSearchMatches>a").text("select from list"),bolShowRecentHistoryLink?(aaRP.storage.showHistory(),aaRP.storage.matchListState="visible"):aaRP.storage.matchListState="hidden"}function setInternalAd(imgURL,imgHref,imgAlt){var adHTML='<a href="'+imgHref+'"><img src="'+imgURL+'" alt="'+imgAlt+'" /></a>';$("#internalAdvert").html(adHTML),$("#nearbyHotels").html(""),$("#internalAdvert").show()}function selectNodeMatch(gazstring,id,inputid){return $("#"+id).val(gazstring),$("#"+inputid).val(getPlaceFromGazString(gazstring)),$("#"+id+"-list").hide(),$("#linkToggle"+id).text("select from list"),!1}function selectACNodeMatch(placeId,description,id,inputid,bolClearResults){return void 0==placeId?void(window.console&&console.log("placeId undefined")):($("#"+inputid).val(description).focus(),bolClearResults&&$(".matchWrapper.autocomplete").html("").hide().css("position","static"),void getAndSetACPlace(placeId))}function getPlaceFromGazString(gazstring){if(""!=gazstring&&null!=gazstring){var arrGazString=gazstring.split("|"),placeName=unescape(arrGazString[1]);return placeName}return""}function forceRepaint(){"Microsoft Internet Explorer"==navigator.appName&&$("#route").removeClass("repaint").addClass("repaint")}function openPrintPreview(){var params=getRouteURLParams(),protocol="http://",domain="www.theaa.com";window.location.host&&(domain=window.location.host),window.location.protocol&&(protocol=window.location.protocol);var newscreenWidth=Math.floor(.9*$(window).width()),newscreenHeight=Math.floor(.9*$(window).height());return newscreenWidth>880&&(newscreenWidth=880),window.open(protocol+"//"+domain+"/route-planner/print-preview/index.jsp?"+params,"","location=1,status=0,scrollbars=1,toolbar=1,menubar=1,resizable=1,width="+newscreenWidth+",height="+newscreenHeight),!1}function getRouteURLParams(){var confirmFrom=$("#confirmFrom").val(),confirmTo=$("#confirmTo").val(),viaChoice0=$("#viaChoice0").val(),viaChoice1=$("#viaChoice1").val(),viaChoice2=$("#viaChoice2").val(),viaChoice3=$("#viaChoice3").val(),unit=distanceConversion==metresToMiles?"mi":"km";void 0==viaChoice0&&(viaChoice0=""),void 0==viaChoice1&&(viaChoice1=""),void 0==viaChoice2&&(viaChoice2=""),void 0==viaChoice3&&(viaChoice3="");var checkAvoidMotorways=document.getElementById("avoidMotorways"),checkAvoidTolls=document.getElementById("avoidTolls"),checkAvoidTraffic=document.getElementById("avoidTraffic"),bAvoidMWays=null==checkAvoidMotorways?!1:checkAvoidMotorways.checked,bAvoidTolls=null==checkAvoidTolls?!1:checkAvoidTolls.checked,bAvoidTraffic=null==checkAvoidTraffic?!1:checkAvoidTraffic.checked,params="f="+escape(confirmFrom)+"&t="+escape(confirmTo)+"&v0="+escape(viaChoice0)+"&v1="+escape(viaChoice1)+"&v2="+escape(viaChoice2)+"&v3="+escape(viaChoice3)+"&u="+unit;return bAvoidMWays&&(params+="&am="+bAvoidMWays),bAvoidTolls&&(params+="&at="+bAvoidTolls),bAvoidTraffic&&(params+="&atr="+bAvoidTraffic),0!=aaRP.selectedAltRoute&&(params+="&rid="+aaRP.selectedAltRoute),params}function setTabLinks(map){var hotelLink,lat,lng,center,loc,toPlaceValue=$("#confirmTo").val();null!=toPlaceValue&&""!=toPlaceValue?(placeValue=toPlaceValue.split("|"),lat=placeValue[4],lng=placeValue[3],loc=escape(placeValue[1])):(center=map.getCenter(),lat=center.lat(),lng=center.lng()),hotelLink="/maps/hotel-search.jsp#lat="+lat+"%7Clng="+lng+"%7Cz="+map.getZoom(),null!=loc&&(hotelLink+="%7Cloc="+loc),$("#maplinkHotels a").attr("href",hotelLink)}function toggleSideBar(elem){var $route=$("#route"),$routeSettings=$("#routeSettings");if($route.hasClass("defaultHidden")&&$routeSettings.hasClass("defaultHidden")){aaRP.displayPanel(aaRP.state.openPanelID);var center=mapAA.getCenter();$("#map").css("margin-left",""),google.maps.event.trigger(mapAA,"resize"),mapAA.setCenter(center),$("#sidebarSlider").removeClass("togglePanelOpen")}else{$route.addClass("defaultHidden"),$routeSettings.addClass("defaultHidden");var center=mapAA.getCenter();$("#map").css("margin-left","0"),google.maps.event.trigger(mapAA,"resize"),mapAA.setCenter(center),$("#sidebarSlider").addClass("togglePanelOpen")}}function getURLParameter(paramName){var sURL=window.document.URL.toString();if(sURL.indexOf("?")>0){var arrParams=sURL.split("?"),arrURLParams=arrParams[1].split("&"),arrParamNames=new Array(arrURLParams.length),arrParamValues=new Array(arrURLParams.length),i=0;for(i=0;i<arrURLParams.length;i++){var sParam=arrURLParams[i].split("=");arrParamNames[i]=sParam[0],""!=sParam[1]?arrParamValues[i]=unescape(sParam[1]):arrParamValues[i]="No Value"}for(i=0;i<arrURLParams.length;i++)if(arrParamNames[i]==paramName)return arrParamValues[i];return""}}function populateHotelsBarGaz(){var selectTo=document.getElementById("confirmTo"),gazLocString=escape(selectTo.value);if(!checkPortLocation(gazLocString)){var lat="",lng="";arrGaz=gazLocString.split("%7C"),(-1!=arrGaz[3].indexOf(".")||-1!=arrGaz[4].indexOf("."))&&(lat=arrGaz[4],lng=arrGaz[3]),populateHotelsBarByDestination(lat,lng,"overlayMapMessage",gazLocString)}}function populateHotelsBarByDestination(lat,lon,poiMsgID,gazLocString){if(""!=lat&&null!=lat){var ukireBounds=new google.maps.LatLngBounds(new google.maps.LatLng(49.724479,-11.173096),new google.maps.LatLng(61.689872,1.889648));if(!ukireBounds.contains(new google.maps.LatLng(lat,lon)))return void $("#nearbyHotels").html("")}var $nearbyHotelsElement=$("#nearbyHotels"),padding=14,margin=20,hotelBarWidth=$nearbyHotelsElement.outerWidth(!0)-padding-margin,maxHotelsToDisplay=Math.floor(hotelBarWidth/213),baseRequest="/aaservlet/poi-search",baseParameters="poitype=123&lat="+lat+"&long="+lon+"&maxresults="+maxHotelsToDisplay;""==lat&&""==lon&&""!=gazLocString&&(baseParameters="poitype=123&gazLocation="+gazLocString+"&maxresults="+maxHotelsToDisplay);var bolMarkersOnMap=!0;""!=gazLocString&&(bolMarkersOnMap=!1),$.ajax({url:baseRequest,type:"get",data:baseParameters,dataType:"json",error:function(xhr,desc,exceptionobj){$nearbyHotelsElement.html("")},success:function(json){populateHotelsBarFromJson(json,bolMarkersOnMap,poiMsgID,gazLocString)}})}function populateHotelsBarFromJson(json,bolMarkersOnMap,poiMsgID,gazLocString){var $nearbyHotelsElement=$("#nearbyHotels"),padding=14,margin=20,hotelBarWidth=$nearbyHotelsElement.outerWidth(!0)-padding-margin,maxHotelsToDisplay=Math.floor(hotelBarWidth/213),strHTMLOutput='<div class="hotelsPanelHeader clearfix">';if(strHTMLOutput+=bolMarkersOnMap?"<h2>AA Hotels &amp; B&amp;Bs nearby</h2>":"<h2>AA Hotels &amp; B&amp;Bs near your destination</h2>",!bolMarkersOnMap&&""!=gazLocString){var arrGazString=gazLocString.split("%7C"),placeArr=arrGazString[1].split("%2C"),placeName=unescape(placeArr[0]),tmpEastings=arrGazString[3],tmpNorthings=arrGazString[4];-1==tmpEastings.indexOf(".")&&-1==tmpNorthings.indexOf(".")&&(strHTMLOutput+='<h3><a href="/travel/basicsearch/hotelSearchProxyAction.do?loc= '+gazLocString+'"',strHTMLOutput+=">View all Hotels &amp; B&amp;Bs in "+placeName+"</a></h3>")}strHTMLOutput+='</div><div class="hotelsPanel clearfix">';var hotelCount=0;$.each(json.summaries,function(i,poiItem){var strName=poiItem.name,strlongitude=poiItem.longitude,starColour=(poiItem.summary,poiItem.isRedStars,poiItem.starColour),imageUrl=isEmpty(poiItem.imageUrl),poiTypeID=poiItem.poiType,strcategory=(isEmpty(poiItem.percent),isEmpty(poiItem.category)),strlatitude=poiItem.latitude,strqualityRating=isEmpty(poiItem.qualityRating),bolaaRated=isEmpty(poiItem.aaRated),appointmentCurrent=isEmpty(poiItem.appointmentCurrent),liteMembership=isEmpty(poiItem.racGrade),strShortName=strName;strShortName.length>20&&(strShortName=strShortName.substring(0,19)+"...");var strPOIid=poiItem.id,starImage=starColour+"-star-"+strqualityRating+".gif",tmpStrPOIType=getPOITypeFromID(poiTypeID);return strHTMLOutput+='<div class="hotelsPanelThird clearfix"><a href="/travel/details/'+tmpStrPOIType+"/"+strPOIid+'" onclick="showSinglePOI(mapAA,'+strlatitude+","+strlongitude+","+strPOIid+","+poiTypeID+",true,true,'"+escape(strName)+'\'); return false;" title="Show on map: '+strName+'" class="clearfix"><div class="hotelsPanelTxt"><h4>'+strShortName+"</h4><p>",!(bolaaRated||""!=liteMembership&&parseInt(liteMembership,10)>0)||102!=poiTypeID&&103!=poiTypeID&&104!=poiTypeID||(strHTMLOutput+='<img src="/images/logos/aa-logo-16.gif" width="16" height="16" class="aalogo-hotelbar" alt="AA logo" />',""==liteMembership||parseInt(liteMembership,10)<=0?"U"==appointmentCurrent?strHTMLOutput+='<img class="rating-unconfirmed" src="/images/getaway/hotels/ungraded_icon.gif" alt="Unconfirmed grading" />':""==strqualityRating||isNaN(strqualityRating)||"0"==strqualityRating||("A"==appointmentCurrent&&(strHTMLOutput+='<img class="rating-associate" src="/images/getaway/hotels/associate_cross.gif" alt="AA Associate" />'),strHTMLOutput+='<span class="hbStarrating"><img src="/images/travel/places_to_stay/'+starImage+'" alt="'+strqualityRating+" "+starColour+' star" /></span>'):strHTMLOutput+='<span class="aaadvertised"> Advertised</span>'),(""==liteMembership||parseInt(liteMembership,10)<=0)&&(strHTMLOutput+="<br />"+strcategory),strHTMLOutput+="</p></div>",strHTMLOutput+='<div class="hotelsPanelImg">',""==imageUrl&&(imageUrl="/images/routes/hotelbar-no-image-48x40.gif"),strHTMLOutput+='<img src="'+imageUrl+'" alt="'+strName+'" />',strHTMLOutput+="</div>",strHTMLOutput+="</a></div>",hotelCount++,i==maxHotelsToDisplay-1?!1:void hotelCount++}),strHTMLOutput+="</div>",hidePOIMsg("#overlayMapMessage"),hotelCount>0?($("#internalAdvert").hide(),$nearbyHotelsElement.html(strHTMLOutput)):($("#internalAdvert").show(),$nearbyHotelsElement.html(""))}function checkPortLocation(gazLocString){var arrPorts=new Array("dover","portsmouth","harwich","folkestone","hull","new haven","poole","plymouth","fishguard","hollyhead","liverpool","stranraer");if(""!=gazLocString){var tmpLoc=gazLocString.toLowerCase();for(i=0;i<arrPorts.length;i++)if(tmpLoc.indexOf("%7c"+arrPorts[i])>-1||tmpLoc.indexOf("%20"+arrPorts[i])>-1)return setInternalAd("/images/routes/european-breakdown-cover.gif","/breakdown-cover/european-breakdown-cover.jsp","Get European breakdown cover"),!0}return!1}function sendTweet(e){var confFromGaz=$("#confirmFrom").val(),confToGaz=$("#confirmTo").val(),confFromPlace=getGazPlaceFromString(confFromGaz),confToPlace=getGazPlaceFromString(confToGaz),dist=$("#routeDistanceValue").text();dist=dist.replace("miles","mi"),dist=dist.replace(/\s+/g,"");var tText=encodeURIComponent("I'm planning a journey from "+confFromPlace+" to "+confToPlace);""!=dist&&(tText+=encodeURIComponent(" ("+dist+")"));var turl="https://twitter.com/intent/tweet?original_referer=&text="+tText,confFromVal=encodeURIComponent(decodeURI(confFromGaz)).replace(/\%20/g,"%2520").replace(/\%7C/g,"%257C"),confToVal=encodeURIComponent(decodeURI(confToGaz)).replace(/\%20/g,"%2520").replace(/\%7C/g,"%257C"),hash="fromNode%3D"+confFromVal+"%257CtoNode%3D"+confToVal;turl=turl+"&url=http%3A%2F%2Fwww.theaa.com%2Froute-planner%2Findex.jsp?XCID=SocialMedia%26PLA=Twitter%26CRE=ROPLAPP%23"+hash+"&hashtags=AARoutePlanner",confToPlace.length+confFromPlace.length+dist.length<=52&&(turl+="&via=TheAA_UK"),n=550,r=420,i=screen.height,s=screen.width,o=Math.round(s/2-n/2),u=Math.round(i/2-r/2),window.open(turl,"_blank","scrollbars=yes,resizable=yes,toolbar=no,location=yes,width=550,height=420,left="+o+",top="+u),e&&e.preventDefault?e.preventDefault():window.event&&window.event.returnValue&&(window.eventReturnValue=!1)}function formatWGSReq(str){return""!=str&&void 0!=str&&(arrInp=str.split("|"),(-1!=arrInp[3].indexOf(".")||-1!=arrInp[4].indexOf("."))&&(str=arrInp[4]+","+arrInp[3]+";WGS84")),str}function convertAndGetGoogleLatLng(coordA,coordB){if(null!=coordA&&void 0!=coordA&&null!=coordB&&void 0!=coordB&&(-1==coordA.indexOf(".")||-1==coordB.indexOf("."))){
var geo=ConvertBNGtoWGS84(coordB,coordA);return new google.maps.LatLng(geo.latitude,geo.longitude)}return new google.maps.LatLng(coordA,coordB)}function filterGRoutesText(str){return null==str||""==str?str:(str=str.replace(/<div style="font-size:0.9em">Speed camera(s begin| within)?(s in| in)? (\d)+\.?(\d)+&nbsp;mi<\/div>/,""),str=str.replace(/\//g," / "))}function formatGazStringAsLatLngString(strGazNode){return arrGazString=strGazNode.split("|"),tmpLatLng=convertAndGetGoogleLatLng(arrGazString[4],arrGazString[3]),arrGazString[0]=0,arrGazString[3]=tmpLatLng.lng().toFixed(6),arrGazString[4]=tmpLatLng.lat().toFixed(6),arrGazString.join("|")}function ContextMenu(map,options){options=options||{},this.setMap(map),this.classNames_=options.classNames||{},this.map_=map,this.mapDiv_=map.getDiv(),this.menuItems_=options.menuItems||[],this.pixelOffset=options.pixelOffset||new google.maps.Point(10,-5)}function initContextMenu(){var contextMenuOptions={};contextMenuOptions.classNames={offer:"context_menu",menuSeparator:"context_menu_separator"};var menuItems=[];menuItems.push({className:"context_menu_item",eventName:"directions_origin_click",id:"directionsOriginItem",label:"Directions from here"}),menuItems.push({className:"context_menu_item",eventName:"directions_destination_click",id:"directionsDestinationItem",label:"Directions to here"}),menuItems.push({className:"context_menu_item",eventName:"addvia_click",id:"directionsViaItem",label:"Via here"}),menuItems.push({}),menuItems.push({className:"context_menu_item",eventName:"zoom_in_click",label:"Zoom in"}),menuItems.push({className:"context_menu_item",eventName:"zoom_out_click",label:"Zoom out"}),menuItems.push({}),menuItems.push({className:"context_menu_item",eventName:"center_map_click",label:"Center map here"}),contextMenuOptions.menuItems=menuItems,aaRP.aaContextMenu=new ContextMenu(mapAA,contextMenuOptions),aaContextMenuListener=google.maps.event.addListener(mapAA,"rightclick",function(mouseEvent){aaRP.aaContextMenu.show(mouseEvent.latLng)}),google.maps.event.addListener(aaRP.aaContextMenu,"menu_item_selected",function(latLng,eventName){switch(eventName){case"directions_origin_click":draggedRoute=!0,$("#routeMessage").html("").hide(),$("#routeTargetedAd").hide(),$("#classiclink").hide(),setLatLngMarker(latLng,0),gMarkers.length>1&&onGetNewRoute(!0,"",!0,!1);break;case"directions_destination_click":if(draggedRoute=!0,$("#routeMessage").html("").hide(),$("#routeTargetedAd").hide(),$("#classiclink").hide(),!gMarkers.length){var errorMsg="Please select your start location first.";return void $("#routeMessage").html("<div><p>"+errorMsg+"</p></div>").show()}1==gMarkers.length?setLatLngMarker(latLng,1):gMarkers.length>1&&setLatLngMarker(latLng,gMarkers.length-1),onGetNewRoute(!0,"",!0,!1);break;case"addvia_click":if(viaCount>viaLimit)return $("#routeMessage").html("Sorry, only "+(viaLimit+1)+" via locations allowed.").show(),forceRepaint(),!1;if(draggedRoute=!0,$("#routeMessage").html("").hide(),$("#routeTargetedAd").hide(),$("#classiclink").hide(),!gMarkers.length){var errorMsg="Please select your start location first.";return void $("#routeMessage").html("<div><p>"+errorMsg+"</p></div>").show()}if(1==gMarkers.length){var errorMsg="Please select your end location first.";return void $("#routeMessage").html("<div><p>"+errorMsg+"</p></div>").show()}if(gMarkers.length>1){if(viaCount+2>gMarkers.length)for(var i=viaCount+2;i>gMarkers.length;i--)removeVia(i-3);createVia(),setLatLngMarker(latLng,-1)}onGetNewRoute(!0,"",!0,!1);break;case"zoom_in_click":mapAA.setZoom(mapAA.getZoom()+1);break;case"zoom_out_click":mapAA.setZoom(mapAA.getZoom()-1);break;case"center_map_click":mapAA.panTo(latLng)}})}function setLatLngMarker(latLng,i){if(null!=gMarkers.length&&void 0!=gMarkers[i]||-1==i?-1!=i&&gMarkers[i].setPosition(latLng):createRouteMarker(latLng,i,latLng.lat().toFixed(6)+", "+latLng.lng().toFixed(6),!0),-1==i){gMarkers.splice(gMarkers.length-1,0,{});var IconOrigin=26*(gMarkers.length-1),IconHeight=135;(null==IconOrigin||0>IconOrigin)&&(IconOrigin=0),Icon={url:"/resources/images/maps/map-sprite-005.png",size:new google.maps.Size(26,34),origin:new google.maps.Point(IconOrigin,IconHeight),anchor:new google.maps.Point(13,34)},gMarkers[gMarkers.length-1].setIcon(Icon),gMarkers[gMarkers.length-1].routePosition=gMarkers.length-1,createRouteMarker(latLng,gMarkers.length-2,latLng.lat().toFixed(6)+", "+latLng.lng().toFixed(6),!0),setViaLatLngValues(gMarkers.length-2,latLng)}else 0==i?($("#confirmFromMatches").html("").hide(),setWhiteBG(document.getElementById("routeFrom")),$("#routeFrom").val(latLng.lat().toFixed(6)+", "+latLng.lng().toFixed(6)),$("#confirmFrom").val("0|Unknown||"+latLng.lng().toFixed(6)+"|"+latLng.lat().toFixed(6)),isNewFromValue=!1):i+1==gMarkers.length?($("#confirmToMatches").html("").hide(),setWhiteBG(document.getElementById("routeTo")),$("#routeTo").val(latLng.lat().toFixed(6)+", "+latLng.lng().toFixed(6)),$("#confirmTo").val("0|Unknown||"+latLng.lng().toFixed(6)+"|"+latLng.lat().toFixed(6)),isNewToValue=!1):gMarkers.length>2&&i+1<=gMarkers.length&&setViaLatLngValues(i,latLng)}function setViaLatLngValues(k,latLng){$("#via"+(k-1)).val(latLng.lat().toFixed(6)+", "+latLng.lng().toFixed(6)),$("#viaChoice"+(k-1)).val(latLng.lat().toFixed(6)+"|"+latLng.lng().toFixed(6)+"|WSG84"),$("#viaChoice"+(k-1)).val("0|Unknown||"+latLng.lng().toFixed(6)+"|"+latLng.lat().toFixed(6)),1==k?(isNewVia0Value=!1,setWhiteBG(document.getElementById("viaChoice0"))):2==k?(isNewVia1Value=!1,setWhiteBG(document.getElementById("viaChoice1"))):3==k?(isNewVia2Value=!1,setWhiteBG(document.getElementById("viaChoice2"))):4==k?(isNewVia3Value=!1,setWhiteBG(document.getElementById("viaChoice3"))):5==k&&(isNewVia4Value=!1,setWhiteBG(document.getElementById("viaChoice4")))}function setRouteMarkersDraggable(draggable){if(gMarkers.length>0)for(i=0;i<gMarkers.length;i++)gMarkers[i].setDraggable(draggable)}function postRouteTidyUp(){draggedRoute=!1}function getAutoCompleteList(inpID){if(inpStr=$("#"+inpID).val(),inpStr.length<3)return void hideACMatchList(aaRP.autoComplete.confirmID);var bounds=new google.maps.LatLngBounds(new google.maps.LatLng(49.5,-10.6),new google.maps.LatLng(61,2));autoCompleteService.getPlacePredictions({input:inpStr,bounds:bounds},showAutoCompleteList)}function showAutoCompleteList(predictions,status){if(status==google.maps.places.PlacesServiceStatus.OK){for(var prediction,$tmpMatchElem=$("#"+aaRP.autoComplete.confirmID+"Matches"),strOut="",i=0;prediction=predictions[i];i++)strOut+='\n<div data-placeId="'+prediction.place_id+'" data-desc="'+prediction.description+'" class="matchplace autocompleteitem">'+prediction.description+"</div>";$tmpMatchElem.html("<div id='"+aaRP.autoComplete.confirmID+"-list' class='matchWrapper autocomplete'>"+strOut+"</div>").show();var $elem=$("#"+aaRP.autoComplete.confirmID+"-list");$elem.css({position:"absolute",marginLeft:0,marginTop:0,top:"auto",left:"auto"}),$elem.show()}}function getAndSetACPlace(placeId){aaGeoCoder.geocode({placeId:placeId},setACGeoPlace)}function setACGeoPlace(results,status){if(status==google.maps.GeocoderStatus.OK){var strOutputVal="";if(-1==results[0].formatted_address.indexOf(","))strOutputVal=results[0].formatted_address;else try{arrFormattedAddr=results[0].formatted_address.split(","),trim(arrFormattedAddr[0].toLowerCase())==trim(arrFormattedAddr[1].toLowerCase())&&arrFormattedAddr.shift(),trim(arrFormattedAddr[0].toLowerCase())==trim(arrFormattedAddr[1].toLowerCase())&&arrFormattedAddr.shift(),arrFormattedAddr[0]=trim(arrFormattedAddr[0]),strOutputVal=arrFormattedAddr.join(",")}catch(e){strOutputVal=results[0].formatted_address}$("#"+aaRP.autoComplete.confirmID).val("0|"+strOutputVal+"||"+results[0].geometry.location.lng().toFixed(6)+"|"+results[0].geometry.location.lat().toFixed(6)),"confirmTo"==aaRP.autoComplete.confirmID?isNewToValue=!1:"confirmFrom"==aaRP.autoComplete.confirmID?isNewFromValue=!1:"viaChoice0"==aaRP.autoComplete.confirmID?isNewVia0Value=!1:"viaChoice1"==aaRP.autoComplete.confirmID?isNewVia1Value=!1:"viaChoice2"==aaRP.autoComplete.confirmID?isNewVia2Value=!1:"viaChoice3"==aaRP.autoComplete.confirmID&&(isNewVia3Value=!1)}}function setACPlace(result,status){status==google.maps.places.PlacesServiceStatus.OK&&result.geometry&&($("#"+aaRP.autoComplete.confirmID).val("0|"+result.name+"||"+result.geometry.location.lng().toFixed(6)+"|"+result.geometry.location.lat().toFixed(6)),"confirmTo"==aaRP.autoComplete.confirmID?isNewToValue=!1:"confirmFrom"==aaRP.autoComplete.confirmID?isNewFromValue=!1:"viaChoice0"==aaRP.autoComplete.confirmID?isNewVia0Value=!1:"viaChoice1"==aaRP.autoComplete.confirmID?isNewVia1Value=!1:"viaChoice2"==aaRP.autoComplete.confirmID?isNewVia2Value=!1:"viaChoice3"==aaRP.autoComplete.confirmID&&(isNewVia3Value=!1))}function hideACMatchList(confID){$("#"+confID+"-list").parent().hide()}function aaDebug(str){debugEnabled&&(0==$("#debug").length&&$("body").append("<div id='debug' style='position:absolute;width:300px;top:100px;right:0;background-color:#000; opacity:0.5;color:#fff;z-index:1000;max-height:200px;overflow:scroll;'>Debug:</div>"),$("#debug").show(),$("#debug").append("<p>"+str+"</p>"))}function zoomTraffic(){setTimerClearAndReloadTraffic()}function moveTraffic(){setTimerClearAndReloadTraffic()}function setTimerClearAndReloadTraffic(){var curZoom=mapAA.getZoom();4>=curZoom||curZoom>17||!$("#dispTrafficAlert").prop("checked")||(0!=aaTraffic.alertCallTimer&&clearTimeout(aaTraffic.alertCallTimer),aaTrafficOverlay&&null!=aaTrafficOverlay.trafficXHR&&aaTrafficOverlay.trafficXHR.abort(),aaTraffic.alertCallTimer=setTimeout(function(){clearAndReloadTraffic()},500))}function clearAndReloadTraffic(){aaTrafficOverlay.displayTrafficAlertOverlay(mapAA,!0,"overlayMapMessage",{alerts:!0,roadworks:!1,congestion:!1})}function reformatGoogleRouteResponse(results){var reformattedResponse={status:results.status,routes:this.reformatGoogleRoutes(results.routes)};return reformattedResponse}function reformatGoogleRoutes(routes){var reformattedRoutes=[];return $.each(routes,function(ix,route){var newRoute={summary:route.summary,bounds:reformatGoogleBounds(route.bounds),copyrights:route.copyrights,overview_polyline:{points:route.overview_polyline},legs:reformatGoogleLegs(route.legs)};reformattedRoutes.push(newRoute)}),reformattedRoutes}function reformatGoogleLegs(legs){var reformattedLegs=[];return $.each(legs,function(ix,leg){var newLeg={distance:leg.distance,duration:leg.duration,end_address:leg.end_address,end_location:reformatGoogleLatLng(leg.end_location),start_address:leg.start_address,start_location:reformatGoogleLatLng(leg.start_location),steps:reformatGoogleSteps(leg.steps)};leg.duration_in_traffic&&null!=leg.duration_in_traffic&&(newLeg.duration_in_traffic=leg.duration_in_traffic),reformattedLegs.push(newLeg)}),reformattedLegs}function reformatGoogleSteps(steps){var reformattedSteps=[];return $.each(steps,function(ix,step){var newStep={distance:step.distance,duration:step.duration,end_location:reformatGoogleLatLng(step.end_location),start_location:reformatGoogleLatLng(step.start_location),html_instructions:step.instructions,maneuver:step.maneuver,polyline:step.polyline,travel_mode:step.travel_mode};reformattedSteps.push(newStep)}),reformattedSteps}function reformatGoogleBounds(bounds){return{northeast:reformatGoogleLatLng(bounds.getNorthEast()),southwest:reformatGoogleLatLng(bounds.getSouthWest())}}function reformatGoogleLatLng(latlng){return reformattedLatLng={lat:latlng.lat().toFixed(6),lng:latlng.lng().toFixed(6)}}!function(){function createBar(){var div=document.createElement("div");div.id="aaCookiebar",document.body.firstChild?document.body.insertBefore(div,document.body.firstChild):document.body.appendChild(div),document.getElementById("aaCookiebar").style.display="none",document.getElementById("aaCookiebar").setAttribute("class","cc-cookies aanoprint"),document.getElementById("aaCookiebar").innerHTML="<div class='cookie-outer-container'><div class='cookie-text-container'>TheAA.com uses <a title='Visit All about cookies (External link)' href='/termsandconditions/privacy_policy.html#Cookies'>cookies</a>. If you use our site, we'll assume you are happy with this.<div class='cc-cookie-accept-container'><a href='#accept' class='cc-cookie-accept' id='close-cookie-btn' title='Clicking X dismisses this message'><img src='/resources/images/aa-cookies-close.gif' alt='close'></a></div></div></div>";var a;a:{for(var b=document.cookie.split(";"),c=0;c<b.length;c++){for(var d=b[c];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf("aaCookie=")){a=d.substring(14,d.length);break a}}a=null}if(!a){document.getElementById("aaCookiebar").style.display="block";var e=new Date;e.setTime(e.getTime()+12096e5),document.cookie="aaCookie=aaCookiebar; expires="+e.toGMTString()+"; path=/";var cookieBtn=document.getElementById("close-cookie-btn");document.addEventListener?cookieBtn.addEventListener("click",closeCookieBar):document.attachEvent&&cookieBtn.attachEvent("onclick",closeCookieBar)}}function closeCookieBar(event){var bar=document.getElementById("aaCookiebar");bar.parentNode.removeChild(bar),event.preventDefault?event.preventDefault():event.returnValue=!1,$(window).width()<=480&&aaRP.mobile.setMapHeight()}function domReady(cb){function invokeCallBack(){invoked||(invoked=!0,cb())}function tryScroll(){if(!invoked)try{document.documentElement.doScroll("left"),invokeCallBack()}catch(e){setTimeout(tryScroll,10)}}var invoked=!1;if(document.addEventListener?document.addEventListener("DOMContentLoaded",invokeCallBack,!1):document.attachEvent&&document.documentElement.doScroll&&tryScroll(),window.addEventListener)window.addEventListener("load",invokeCallBack,!1);else if(window.attachEvent)window.attachEvent("onload",invokeCallBack);else{var fn=window.onload;window.onload=function(){fn&&fn(),invokeCallBack()}}}domReady(createBar)}();var debugEnabled=!1,aaTraffic=aaTraffic||{};aaTraffic.alertCallTimer=0;var aaRP={hasLocalStorage:!1,hasPlaceErrors:!1,mobile:{},state:{isProcessingStorage:!1,openPanelID:"route"},aaContextMenu:{},autoComplete:{},storage:{},gazRequestCount:0,fn:{},gDirResult:{},selectedAltRoute:{},displayAltRoutes:!0,altRouteOverlay:null,acCallTimer:0},viaCount=0,viaCountDropDown=0,viaLimit=3,errorCol="#fe8600",ROUTE_CONFIRMED=!1,hashvalue=decodeURI(window.location.hash),hasHashValues=!1,_switchParams="";$(document).on("click",".printRouteButton",function(){var href=$(this).attr("href"),newscreenWidth=Math.floor(.9*$(window).width()),newscreenHeight=Math.floor(.9*$(window).height()),randomnumber=Math.floor(11*Math.random()),windowName="printWindow"+randomnumber;return newscreenWidth>880&&(newscreenWidth=880),window.open(href,windowName,"location=1,status=0,scrollbars=1,toolbar=1,menubar=1,resizable=1,width="+newscreenWidth+",height="+newscreenHeight),!1}),aaRP.fn.checkAndSetNewGazValues=function(){var hasNewGazValues=!1;return $("#confirmFrom, #confirmTo,#viaChoice0, #viaChoice1,#viaChoice2,#viaChoice3,#viaChoice4").each(function(index,elem){var gazVal=$(this).val();(void 0==gazVal||""==gazVal)&&(hasNewGazValues=!0,aaRP.gazRequestCount++)}),hasNewGazValues},aaRP.fn.doGazSearchVias=function(){for(count=0;count<viaCount;count++){var viaElemID="via"+count.toString();aaRP.fn.doGazSearch(viaElemID)}},aaRP.fn.doGazSearch=function(elemID){showLoading();var $inputElem=$("#"+elemID),$confirmPlace="";if("routeFrom"==elemID?($confirmPlace=$("#confirmFrom"),$inpGazValue=$confirmPlace.val()):"routeTo"==elemID?($confirmPlace=$("#confirmTo"),$inpGazValue=$confirmPlace.val()):"via0"==elemID?($confirmPlace=$("#viaChoice0"),$inpGazValue=$confirmPlace.val()):"via1"==elemID?($confirmPlace=$("#viaChoice1"),$inpGazValue=$confirmPlace.val()):"via2"==elemID?($confirmPlace=$("#viaChoice2"),$inpGazValue=$confirmPlace.val()):"via3"==elemID?($confirmPlace=$("#viaChoice3"),$inpGazValue=$confirmPlace.val()):"via4"==elemID&&($confirmPlace=$("#viaChoice4"),$inpGazValue=$confirmPlace.val()),void 0!=$inpGazValue&&""!=$inpGazValue)return void(0!=aaRP.gazRequestCount||aaRP.hasPlaceErrors?0==aaRP.gazRequestCount&&hideLoading():getRouteAndDestinationHotelsAndAds());elemID=$inputElem.attr("id");var placeInputVal=$inputElem.val();if(0!=aaRP.acCallTimer&&clearTimeout(aaRP.acCallTimer),""==placeInputVal||"Please enter a location"==placeInputVal)return aaRP.gazRequestCount--,$inputElem.val("Please enter a location"),setErrorBG($inputElem[0]),aaRP.hasPlaceErrors=!0,void(0==aaRP.gazRequestCount&&hideLoading());$inputElem.addClass("inputSpinner");aaGeoCoder.geocode({address:placeInputVal,region:"GB"},function(results,status){status==google.maps.GeocoderStatus.OK?(aaRP.gazRequestCount--,populateGeoCodeField(results,$confirmPlace,$inputElem),setWhiteBG($inputElem[0])):(aaRP.hasPlaceErrors=!0,aaRP.gazRequestCount--,0==aaRP.gazRequestCount&&hideLoading(),$inputElem.val("Location not found"),setErrorBG($inputElem[0]),"routeFrom"==$inputElem.attr("id")&&$("#lnkRecentLocations").hide())})},aaRP.checkLocalStorage=function(){try{localStorage.setItem("routeplannertest","routeplannertest"),localStorage.removeItem("routeplannertest"),aaRP.hasLocalStorage=!0}catch(e){}},aaRP.resetInputs=function(bolKeepTextInputs){$("#routeFrom").val(""),$("#confirmFrom").val(""),bolKeepTextInputs||($("#routeTo").val(""),$("#confirmTo").val("")),$("#avoidMotorways").prop("checked",!1),$("#avoidTolls").prop("checked",!1),clearViaMatches(),bolKeepTextInputs||clearViaInputs()},aaRP.resetMap=function(bolResetInputs,bolKeepTextInputs){if(bolResetInputs&&aaRP.resetInputs(bolKeepTextInputs),"function"==typeof clearAllPOIMarkers&&clearAllPOIMarkers(),"undefined"!=typeof routeOverlay&&null!=routeOverlay&&routeOverlay.setMap(null),"undefined"!=typeof aaRP.aaContextMenu&&aaRP.aaContextMenu.hide(),"undefined"!=typeof gMarkers){for(i=0;i<gMarkers.length;i++)gMarkers[i].setMap(null),gMarkers[i]=null;gMarkers.length=0}},aaRP.addLeadingZero=function(str){var str=str.toString();return 1==str.length?"0"+str:str},aaRP.mobile.setupMobileAd=function(){$(window).width()<=480&&(aaRP.mobile.mobAdElem=$(".advert","#footeraads"),aaRP.mobile.mobAdFixed=!1,$(window).bind("scroll.mobileAd",function(){winScrollPos=$(window).scrollTop(),winScrollPos<50?(aaRP.mobile.mobAdFixed=!1,aaRP.mobile.mobAdElem.css({bottom:-50+winScrollPos+"px"})):aaRP.mobile.mobAdFixed||(aaRP.mobile.mobAdElem.css({bottom:0}),aaRP.mobile.mobAdFixed=!0)}))},aaRP.mobile.setupMobileLinks=function(){$("#mobLinkDir").click(function(){aaRP.mobile.toggleMobilePanel("directions")}),$("#mobLinkMap").click(function(){aaRP.mobile.toggleMobilePanel("map")}),aaRP.mobile.setupMobileAd()},aaRP.mobile.toggleMobilePanel=function(panel){if($(".mobLink a").removeClass("mobLinkSelected"),"directions"==panel)$("#mobLinkDir").addClass("mobLinkSelected"),$("#map").addClass("mobMapHidden"),$("#route").removeClass("defaultHidden"),$("#routeSettings").addClass("defaultHidden"),aaRP.state.openPanelID="route",google.maps.event.trigger(mapAA,"resize"),$(".welcomeMessageMobile").show(),$("#footeraads .advert").css("bottom",""),$("#footer").show(),(void 0==aaRP.mobile.mobAdElem||0==aaRP.mobile.mobAdElem.length)&&(aaRP.mobile.mobAdElem=$(".advert","#footeraads")),$(window).bind("scroll.mobileAd",function(){winScrollPos=$(window).scrollTop(),winScrollPos<50?(aaRP.mobile.mobAdFixed=!1,aaRP.mobile.mobAdElem.css({bottom:-50+winScrollPos+"px"})):aaRP.mobile.mobAdFixed||(aaRP.mobile.mobAdElem.css({bottom:0}),aaRP.mobile.mobAdFixed=!0)});else if("map"==panel){$("#mobLinkMap").addClass("mobLinkSelected");var oldCentre=mapAA.getCenter();$("#route, #routeSettings").addClass("defaultHidden"),aaRP.mobile.setMapHeight(),$("#map").removeClass("mobMapHidden"),$("#footeraads .advert").css("bottom","0"),mapAA.setCenter(oldCentre),$(".welcomeMessageMobile").hide(),$("#footer").hide(),$(window).unbind("resize.desktop"),$(window).bind("resize.desktop",function(){aaRP.mobile.resetMapDT()}),$(window).unbind("scroll.mobileAd"),google.maps.event.trigger(mapAA,"resize")}},aaRP.mobile.resetMapDT=function(){$(window).width()>480&&($("#map").css("height","").removeClass("mobMapHidden"),$("#footer").show(),$("#route").removeClass("defaultHidden"),$("#routeSettings").addClass("defaultHidden"),aaRP.state.openPanelID="route",$(".welcomeMessageMobile").hide(),$(window).unbind("scroll.mobileAd"),aaRP.mobile.mobAdElem.css({bottom:0}),google.maps.event.trigger(mapAA,"resize"))},aaRP.mobile.setMapHeight=function(){var cookieBarHeight=0;$(".cc-cookies").is(":visible")&&(cookieBarHeight=$(".cc-cookies").height()),$("#map").css({height:$(window).height()-52-50-cookieBarHeight})},ContextMenu.prototype=new google.maps.OverlayView,ContextMenu.prototype.draw=function(){if(this.isVisible_){var mapSize=new google.maps.Size(this.mapDiv_.offsetWidth,this.mapDiv_.offsetHeight),menuSize=new google.maps.Size(this.menu_.offsetWidth,this.menu_.offsetHeight),mousePosition=this.getProjection().fromLatLngToDivPixel(this.position_),left=mousePosition.x,top=mousePosition.y;mousePosition.x>mapSize.width-menuSize.width-this.pixelOffset.x?left=left-menuSize.width-this.pixelOffset.x:left+=this.pixelOffset.x,mousePosition.y>mapSize.height-menuSize.height-this.pixelOffset.y?top=top-menuSize.height-this.pixelOffset.y:top+=this.pixelOffset.y,this.menu_.style.left=left+"px",this.menu_.style.top=top+"px"}},ContextMenu.prototype.getVisible=function(){return this.isVisible_},ContextMenu.prototype.hide=function(){this.isVisible_&&(this.menu_.style.display="none",this.isVisible_=!1)},ContextMenu.prototype.onAdd=function(){function createMenuItem(values){var menuItem=document.createElement("div");return menuItem.innerHTML=values.label,values.className&&(menuItem.className=values.className),values.id&&(menuItem.id=values.id),menuItem.style.cssText="cursor:pointer; white-space:nowrap",menuItem.onclick=function(){google.maps.event.trigger($this,"menu_item_selected",$this.position_,values.eventName)},menuItem}function createMenuSeparator(){var menuSeparator=document.createElement("div");return $this.classNames_.menuSeparator&&(menuSeparator.className=$this.classNames_.menuSeparator),menuSeparator}var $this=this,menu=document.createElement("div");this.classNames_.offer&&(menu.className=this.classNames_.offer);for(var i=0,j=this.menuItems_.length; j>i; i++)this.menuItems_[i].label&&this.menuItems_[i].eventName?menu.appendChild(createMenuItem(this.menuItems_[i])):menu.appendChild(createMenuSeparator());delete this.classNames_,delete this.menuItems_,this.isVisible_=!1,this.menu_=menu,this.position_=new google.maps.LatLng(0,0),google.maps.event.addListener(this.map_,"click",function(mouseEvent){$this.hide()}),this.getPanes().floatPane.appendChild(menu)},ContextMenu.prototype.onRemove=function(){this.menu_.parentNode.removeChild(this.menu_),delete this.mapDiv_,delete this.menu_,delete this.position_},ContextMenu.prototype.show=function(latLng){this.isVisible_||(this.menu_.style.display="block",this.isVisible_=!0),this.position_=latLng,this.draw()},aaRP.storage.showHistory=function(id){aaRP.hasLocalStorage&&(arrFromHistory=aaRP.storage.getHistoryByCountry(),0!=arrFromHistory.length&&aaRP.storage.displayHistoryMatchList(arrFromHistory))},aaRP.storage.getHistoryByCountry=function(){try{var localStorageJSON=JSON.parse(localStorage.getItem("aaRPStorage"))}catch(e){return[]}if(null==localStorageJSON)return[];var fromHistory=localStorageJSON.fromHistory;return fromHistory=={}?[]:(arrFromHistoryCountry=fromHistory.GB.concat(fromHistory.IRE,fromHistory.EU),arrFromHistoryCountry&&0!=arrFromHistoryCountry.length?arrFromHistoryCountry:[])},aaRP.storage.displayHistoryLink=function(){if(aaRP.hasLocalStorage){var arrHistory=aaRP.storage.getHistoryByCountry();arrHistory.length>0?($("#lnkRecentLocations").css("display","block"),aaRP.storage.matchListState="hidden",aaRP.storage.updateHistorySettings()):($("#lnkRecentLocations").css("display","none"),aaRP.storage.matchListState="hidden",$("routeSettings-recentLocations").hide())}},aaRP.storage.hideHistoryLink=function(){$("#lnkRecentLocations").css("display","none"),aaRP.storage.matchListState="hidden"},aaRP.storage.updateHistorySettings=function(objHistory){aaRP.hasLocalStorage&&$("#routeSettingsRecentLocations").show();var historyCount=0;(null==objHistory||void 0==objHistory||objHistory==={})&&(historyCount=aaRP.storage.getHistoryCount());var strOut=historyCount+" item";if(1!=historyCount&&(strOut+="s"),$("#recentLocationsCount").html(strOut),$("#lnkClearRecentLocations").show(),0==historyCount)$("#lnkClearRecentLocations").hide(),$("#recentLocationsView").html("");else{strViewOut="";var arrC=aaRP.storage.getHistoryByCountry();for(i=0;i<arrC.length;i++)strViewOut+="<div class='bgLight'>"+getPlaceFromGazString(arrC[i])+"</div>";$("#recentLocationsView").html(strViewOut)}},aaRP.storage.getHistoryCount=function(){var cCount=aaRP.storage.getHistoryByCountry().length;return cCount},aaRP.storage.addToLocalHistory=function(gazLocString){if(""!=gazLocString&&null!=gazLocString&&void 0!=gazLocString){var localStorageJSON={};try{localStorageJSON=JSON.parse(localStorage.getItem("aaRPStorage"))}catch(e){}if(localStorageJSON=={}||null==localStorageJSON)localStorageJSON={},arrFromHistory=new Array(gazLocString);else{for(arrFromHistory=localStorageJSON.arrFromHistory,i=0;i<arrFromHistory.length;i++)if(arrFromHistory[i]==gazLocString)return;arrFromHistory.length<15?arrFromHistory.splice(0,0,gazLocString):(arrFromHistory.length=14,arrFromHistory.splice(0,0,gazLocString))}localStorageJSON.arrFromHistory=arrFromHistory,localStorage.setItem("aaRPStorage",JSON.stringify(localStorageJSON))}},aaRP.storage.addToLocalHistoryCountry=function(gazLocString,country){if(""!=gazLocString&&null!=gazLocString&&void 0!=gazLocString){var localStorageJSON={};try{localStorageJSON=JSON.parse(localStorage.getItem("aaRPStorage"))}catch(e){}localStorageJSON=={}||null==localStorageJSON?localStorageJSON={fromHistory:{GB:[gazLocString],IRE:[],EU:[]}}:((void 0==localStorageJSON.fromHistory||localStorageJSON.fromHistory&&void 0==localStorageJSON.fromHistory.GB)&&(localStorageJSON.fromHistory={GB:[],IRE:[],EU:[]}),void 0==localStorageJSON.fromHistory.GB?localStorageJSON.fromHistory.GB=[gazLocString]:localStorageJSON.fromHistory.GB=aaRP.storage.addUniqueItemToHistoryArray(gazLocString,localStorageJSON.fromHistory.GB)),localStorage.setItem("aaRPStorage",JSON.stringify(localStorageJSON))}},aaRP.storage.addUniqueItemToHistoryArray=function(gazLocString,arr){if(void 0==arr||null==arr)return[gazLocString];for(i=0;i<arr.length;i++)if(arr[i]==gazLocString)return arr;return arr.length<15?arr.splice(0,0,gazLocString):(arr.length=14,arr.splice(0,0,gazLocString)),arr},aaRP.storage.displayHistoryMatchList=function(arrFromHistory){for(var $tmpMatchElem=$("#confirmFromMatches"),strOut="",i=0;i<arrFromHistory.length;i++)strOut+='\n<div data-gaz="'+arrFromHistory[i]+'" class="matchplace storageHistoryItem">'+getGazPlaceFromString(arrFromHistory[i])+"</div>";$tmpMatchElem.html("<div id='confirmFrom-list' class='matchWrapper storageHistory'>"+strOut+"</div>").show();var $elem=$("#confirmFrom-list");$elem.css({position:"absolute",marginLeft:0,marginTop:0,top:"auto",left:"auto"}),$elem.show()},aaRP.storage.selectHistoryItem=function(gazString,inputid,confinputid,bolClearResults){$("#"+inputid).val(getPlaceFromGazString(gazString)).focus(),$("#"+confinputid).val(gazString),isNewFromValue=!1,bolClearResults&&($(".matchWrapper.storageHistory").html("").hide().css("position","static"),aaRP.storage.hideHistoryLink())},aaRP.storage.clearHistory=function(){var localStorageJSON={};try{localStorageJSON=JSON.parse(localStorage.getItem("aaRPStorage"))}catch(e){}localStorageJSON!={}&&null!=localStorageJSON&&(localStorageJSON.fromHistory={},localStorage.setItem("aaRPStorage",JSON.stringify(localStorageJSON)),aaRP.storage.updateHistorySettings({}),$("#recentLocationsView").html(""))},aaRP.displayPanel=function(id){$("#route").addClass("defaultHidden"),$("#routeSettings").addClass("defaultHidden"),$("#"+id).removeClass("defaultHidden"),"routeSettings"==id&&aaRP.storage.updateHistorySettings(),aaRP.state.openPanelID=id},aaRP.addRouteStepMarker=function(inpLat,inpLng){null==routeStepMarker?aaRP.createRouteStepMarker(inpLat,inpLng):(routeStepMarker.setPosition(new google.maps.LatLng(inpLat,inpLng)),routeStepMarker.setMap(mapAA))},aaRP.hideRouteStepMarker=function(){null!=routeStepMarker&&routeStepMarker.setMap(null)},aaRP.createRouteStepMarker=function(inpLat,inpLng){routeStepMarker=new google.maps.Marker({position:new google.maps.LatLng(inpLat,inpLng),icon:{path:google.maps.SymbolPath.CIRCLE,scale:5,fillColor:"#ffffff",fillOpacity:1,strokeWeight:2,strokeColor:"#6c6753"},draggable:!1,map:mapAA})},aaRP.reRouteToLatLng=function(routePosition){setLatLngMarker(aaInfoWindow.getPosition(),routePosition),draggedRoute=!0,aaInfoWindow.close(),"none"==$("#route").css("display")&&($(window).width()<=480?aaRP.mobile.toggleMobilePanel("directions"):aaRP.displayPanel("route")),onGetNewRoute(!0,"",!0,!1)},aaRP.isInteger=function(value){return!isNaN(value)&&-1==value.toString().indexOf(".")&&parseInt(Number(value))==value&&!isNaN(parseInt(value,10))},aaRP.isIntegerOrFloat=function(value){var regex=new RegExp(/^[-+]?([0-9]*\.[0-9]+|[0-9]+)$/);return regex.test(value)?!0:!1},aaRP.formatGazOrLatLng=function(value){return aaRP.isInteger(value)?value:parseFloat(value).toFixed(6)},jQuery.cookie=function(b,j,m){if("undefined"==typeof j){var d=null;if(document.cookie&&""!=document.cookie)for(var k=document.cookie.split(";"),h=0;h<k.length;h++){var c=jQuery.trim(k[h]);if(c.substring(0,b.length+1)==b+"="){d=decodeURIComponent(c.substring(b.length+1));break}}return d}m=m||{},null===j&&(j="",m=$.extend({},m),m.expires=-1);var e="";if(m.expires&&("number"==typeof m.expires||m.expires.toUTCString)){var f;"number"==typeof m.expires?(f=new Date,f.setTime(f.getTime()+24*m.expires*60*60*1e3)):f=m.expires,e="; expires="+f.toUTCString()}var l=m.path?"; path="+m.path:"",g=m.domain?"; domain="+m.domain:"",a=m.secure?"; secure":"";document.cookie=[b,"=",encodeURIComponent(j),e,l,g,a].join("")},!function(o){o.cookieCuttr=function(e){var c={cookieCutter:!1,cookieCutterDeclineOnly:!1,cookieAnalytics:!0,cookieDeclineButton:!1,cookieAcceptButton:!0,cookieResetButton:!1,cookieOverlayEnabled:!1,cookiePolicyLink:"/privacy-policy/",cookieMessage:'We use cookies on our site &ndash; please read our <a href="{{cookiePolicyLink}}" title="read about our cookies">cookies</a> policy for more information. If you continue to use our site, we\'ll assume you\'re happy with our use of cookies.',cookieAnalyticsMessage:"We use cookies on our site &ndash; please read our ",cookieErrorMessage:"We're sorry, this feature places cookies in your browser and has been disabled. <br>To continue using this functionality, please",cookieWhatAreTheyLink:"/termsandconditions/privacy_policy.html#Cookies",cookieDisable:"",cookieExpires:365,cookieAcceptButtonText:"ACCEPT COOKIES",cookieDeclineButtonText:"DECLINE COOKIES",cookieResetButtonText:"RESET COOKIES FOR THIS WEBSITE",cookieWhatAreLinkText:"cookie",cookieNotificationLocationBottom:!1,cookiePolicyPage:!1,cookiePolicyPageMessage:"Please read the information below and then choose from the following options",cookieDiscreetLink:!1,cookieDiscreetReset:!1,cookieDiscreetLinkText:"Cookies?",cookieDiscreetPosition:"topleft",cookieNoMessage:!1,cookieDomain:""},e=o.extend(c,e),i=c.cookieMessage.replace("{{cookiePolicyLink}}",c.cookiePolicyLink);c.cookieMessage='We use cookies on our site &ndash; please read our  <a href="'+c.cookiePolicyLink+'" title="read about our cookies">policy for more information. If you continue to use our site, we\'ll assume you\'re happy with our use of cookies.';var s=e.cookiePolicyLink,t=e.cookieCutter,a=e.cookieCutterDeclineOnly,k=e.cookieAnalytics,n=e.cookieDeclineButton,r=e.cookieAcceptButton,l=e.cookieResetButton,d=e.cookieOverlayEnabled,p=(e.cookiePolicyLink,i),u=e.cookieAnalyticsMessage,v=e.cookieErrorMessage,f=e.cookieDisable,h=e.cookieWhatAreTheyLink,y=e.cookieExpires,m=e.cookieAcceptButtonText,_=e.cookieDeclineButtonText,b=e.cookieResetButtonText,g=e.cookieWhatAreLinkText,D=e.cookieNotificationLocationBottom,x=e.cookiePolicyPage,P=e.cookiePolicyPageMessage,E=e.cookieDiscreetLink,L=e.cookieDiscreetReset,T=e.cookieDiscreetLinkText,A=e.cookieDiscreetPosition,B=e.cookieNoMessage,C="cc_cookie_accept"==o.cookie("cc_cookie_accept");
o.cookieAccepted=function(){return C};var O="cc_cookie_decline"==o.cookie("cc_cookie_decline");if(o.cookieDeclined=function(){return O},r)var w=' <a href="#accept" class="cc-cookie-accept">'+m+"</a> ";else var w="";if(n)var M=' <a href="#decline" class="cc-cookie-decline">'+_+"</a> ";else var M="";if(d)var I="cc-overlay";else var I="";if(D||"bottomright"==A||"bottomleft"==A)var W=!0;else var W=!1;if(C||O)if(l&&L)W?o("body").append('<div class="cc-cookies cc-discreet"><a class="cc-cookie-reset" href="#" title="'+b+'">'+b+"</a></div>"):o("body").prepend('<div class="cc-cookies cc-discreet"><a class="cc-cookie-reset" href="#" title="'+b+'">'+b+"</a></div>"),"topleft"==A&&(o("div.cc-cookies").css("top","0"),o("div.cc-cookies").css("left","0")),"topright"==A&&(o("div.cc-cookies").css("top","0"),o("div.cc-cookies").css("right","0")),"bottomleft"==A&&(o("div.cc-cookies").css("bottom","0"),o("div.cc-cookies").css("left","0")),"bottomright"==A&&(o("div.cc-cookies").css("bottom","0"),o("div.cc-cookies").css("right","0"));else if(l)W?o("body").append('<div class="cc-cookies"><a href="#" class="cc-cookie-reset">'+b+"</a></div>"):o("body").prepend('<div class="cc-cookies"><a href="#" class="cc-cookie-reset">'+b+"</a></div>");else var l="";else B&&!x||(E&&!x?(W?o("body").append('<div class="cc-cookies cc-discreet"><a href="'+s+'" title="'+T+'">'+T+"</a></div>"):o("body").prepend('<div class="cc-cookies cc-discreet"><a href="'+s+'" title="'+T+'">'+T+"</a></div>"),"topleft"==A&&(o("div.cc-cookies").css("top","0"),o("div.cc-cookies").css("left","0")),"topright"==A&&(o("div.cc-cookies").css("top","0"),o("div.cc-cookies").css("right","0")),"bottomleft"==A&&(o("div.cc-cookies").css("bottom","0"),o("div.cc-cookies").css("left","0")),"bottomright"==A&&(o("div.cc-cookies").css("bottom","0"),o("div.cc-cookies").css("right","0"))):k&&(W?o("body").append('<div class="cc-cookies aanoprint '+I+'"><div class="cookie-outer-container"><div class="cookie-text-container">'+u+M+' <a href="'+h+'" title="Visit All about cookies (External link)">'+g+'</a> policy for more information. If you continue to use our site, we\'ll assume you\'re happy with our use of cookies.<div class="cc-cookie-accept-container"><a href="#accept" class="cc-cookie-accept" title="Clicking X dismisses this message"><img src="/resources/images/aa-cookies-close.gif" alt="close"></a></div></div></div></div>'):o("body").prepend('<div class="cc-cookies aanoprint '+I+'"><div class="cookie-outer-container"><div class="cookie-text-container">'+u+M+'<a href="'+h+'" title="Visit All about cookies (External link)">'+g+'</a> policy for more information. If you continue to use our site, we\'ll assume you\'re happy with our use of cookies.<div class="cc-cookie-accept-container"><a href="#accept" class="cc-cookie-accept" title="Clicking X dismisses this message"><img src="/resources/images/aa-cookies-close.gif" alt="close"></a></div></div></div></div>'))),x?W?o("body").append('<div class="cc-cookies '+I+'">'+P+'  <a href="#accept" class="cc-cookie-accept">'+m+'</a>  <a href="#decline" class="cc-cookie-decline">'+_+"</a> </div>"):o("body").prepend('<div class="cc-cookies '+I+'">'+P+'  <a href="#accept" class="cc-cookie-accept">'+m+'</a>  <a href="#decline" class="cc-cookie-decline">'+_+"</a> </div>"):k||E||(W?o("body").append('<div class="cc-cookies '+I+'">'+p+w+M+"</div>"):o("body").prepend('<div class="cc-cookies '+I+'">'+p+w+M+"</div>"));!t||a||!O&&C||o(f).html('<div class="cc-cookies-error">'+v+' <a href="#accept" class="cc-cookie-accept">'+m+"</a> </div>"),t&&a&&O&&o(f).html('<div class="cc-cookies-error">'+v+' <a href="#accept" class="cc-cookie-accept">'+m+"</a> </div>"),D&&!E&&(o("div.cc-cookies").css("top","auto"),o("div.cc-cookies").css("bottom","0")),D&&E&&x&&(o("div.cc-cookies").css("top","auto"),o("div.cc-cookies").css("bottom","0")),o(".cc-cookie-accept, .cc-cookie-decline").click(function(c){c.preventDefault(),o(this).is("[href$=#decline]")?(o.cookie("cc_cookie_accept",null,{path:"/"}),o.cookie("cc_cookie_decline","cc_cookie_decline",{expires:y,path:"/"}),e.cookieDomain&&(o.cookie("__utma",null,{domain:"."+e.cookieDomain,path:"/"}),o.cookie("__utmb",null,{domain:"."+e.cookieDomain,path:"/"}),o.cookie("__utmc",null,{domain:"."+e.cookieDomain,path:"/"}),o.cookie("__utmz",null,{domain:"."+e.cookieDomain,path:"/"}))):(o.cookie("cc_cookie_decline",null,{path:"/"}),o.cookie("cc_cookie_accept","cc_cookie_accept",{expires:y,path:"/"})),o(".cc-cookies").fadeOut(function(){})}),o("a.cc-cookie-reset").click(function(e){e.preventDefault(),o.cookie("cc_cookie_accept",null,{path:"/"}),o.cookie("cc_cookie_decline",null,{path:"/"}),o(".cc-cookies").fadeOut(function(){})}),o(".cc-cookies-error a.cc-cookie-accept").click(function(e){e.preventDefault(),o.cookie("cc_cookie_accept","cc_cookie_accept",{expires:y,path:"/"}),o.cookie("cc_cookie_decline",null,{path:"/"})})}}(jQuery),aaRP.fn.showAltRoute=function(routeID){var altSymbol={path:google.maps.SymbolPath.CIRCLE,strokeColor:"#666",fillColor:"#f0f",fillOpacity:.5,strokeWeight:1,strokeOpacity:1},polyOptions={clickable:!1,strokeOpacity:0,icons:[{icon:altSymbol,offset:"0",repeat:"10px",scale:10}],path:Decode(aaRP.gDirResult.routes[routeID].overview_polyline)};null==aaRP.altRouteOverlay?aaRP.altRouteOverlay=new google.maps.Polyline(polyOptions):aaRP.altRouteOverlay.setOptions(polyOptions),aaRP.altRouteOverlay.setMap(mapAA)},aaRP.fn.hideAltRoute=function(){null!=aaRP.altRouteOverlay&&aaRP.altRouteOverlay.setMap(null)},aaRP.fn.isValidGazNode=function(strNode){return strNode=decodeURI(strNode),arrGaz=strNode.split("|"),5!=arrGaz.length?!1:aaRP.isIntegerOrFloat(arrGaz[0])&&aaRP.isIntegerOrFloat(arrGaz[3])&&aaRP.isIntegerOrFloat(arrGaz[4])?!0:!1},"function"!=typeof Object.create&&(Object.create=function(o){var F=function(){};return F.prototype=o,new F});
//# sourceMappingURL=route-functions-006.min.js.map